# ‚úÖ –°–ò–°–¢–ï–ú–ê –û–ë–ù–û–í–õ–ï–ù–ê –î–õ–Ø –í–ò–î–ï–û–§–ê–ô–õ–û–í - –ò–¢–û–ì–û–í–´–ô –û–¢–ß–Å–¢

–î–∞—Ç–∞: 23 –¥–µ–∫–∞–±—Ä—è 2025

---

## üéâ –ß–¢–û –°–î–ï–õ–ê–ù–û

### ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `detect_violations.py`:

1. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤** - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å MP4, AVI, MOV, MKV –∏ –¥—Ä.
2. **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (tqdm)
3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–∏–¥–µ–æ** - –ø–æ–ª–Ω–æ–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
4. **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ü–µ–ª—É—é –ø–∞–ø–∫—É –≤–∏–¥–µ–æ
5. **–ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–∫–Ω–∞ (--no-display)
6. **–ì–∏–±–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (--no-save)

### ‚úÖ –°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ —Ñ–∞–π–ª—ã:

- **`process_video.bat`** - —É–¥–æ–±–Ω—ã–π –∑–∞–ø—É—Å–∫ –¥–ª—è Windows (–ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∏ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å)
- **`VIDEO_GUIDE.md`** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–±–æ—Ç–µ —Å –≤–∏–¥–µ–æ
- **`VIDEO_CHEATSHEET.md`** - –∫—Ä–∞—Ç–∫–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞
- **`UPDATED_FOR_VIDEO.md`** - —ç—Ç–æ—Ç —Ñ–∞–π–ª
- **`videos_to_process/`** - –ø–∞–ø–∫–∞ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –≤–∏–¥–µ–æ

### ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–∞–∫–µ—Ç—ã:

- **tqdm** - –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞ (—É–∂–µ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

---

## üöÄ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ (3 –°–ü–û–°–û–ë–ê)

### üéØ –°–ø–æ—Å–æ–± 1: –ü–µ—Ä–µ—Ç–∞—â–∏—Ç—å –Ω–∞ .bat —Ñ–∞–π–ª (–°–ê–ú–´–ô –ü–†–û–°–¢–û–ô)

1. –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª **`process_video.bat`**
2. –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ **–≤–∏–¥–µ–æ—Ñ–∞–π–ª** –∏–ª–∏ **–ø–∞–ø–∫—É —Å –≤–∏–¥–µ–æ**
3. –ì–æ—Ç–æ–≤–æ! üéâ

### üìã –°–ø–æ—Å–æ–± 2: –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (–æ–¥–Ω–æ –≤–∏–¥–µ–æ)

```powershell
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ venv
.\.venv\Scripts\Activate.ps1

# –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ –≤–∏–¥–µ–æ
python detect_violations.py --source "video.mp4" --no-display
```

### üìÅ –°–ø–æ—Å–æ–± 3: –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (–ø–∞–ø–∫–∞ —Å –≤–∏–¥–µ–æ)

```powershell
# –ü–æ–ª–æ–∂–∏—Ç–µ –≤—Å–µ –≤–∏–¥–µ–æ –≤ videos_to_process/
python detect_violations.py --batch "videos_to_process" --no-display
```

---

## üìä –ü–ê–†–ê–ú–ï–¢–†–´ –ö–û–ú–ê–ù–î–ù–û–ô –°–¢–†–û–ö–ò

```
--source PATH         –ü—É—Ç—å –∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—É –∏–ª–∏ 0 –¥–ª—è –≤–µ–±-–∫–∞–º–µ—Ä—ã
--batch PATH          –ü–∞–ø–∫–∞ —Å –≤–∏–¥–µ–æ –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
--model PATH          –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏ (default: models/best.pt)
--no-display          –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–∫–Ω–æ (–±—ã—Å—Ç—Ä–µ–µ!)
--no-save             –ù–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø–æ–ª–Ω–æ–µ –≤–∏–¥–µ–æ (—ç–∫–æ–Ω–æ–º–∏—è –º–µ—Å—Ç–∞)
```

---

## üìÇ –°–¢–†–£–ö–¢–£–†–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ:

```
output/
‚îú‚îÄ‚îÄ processed_videos/           ‚Üê üé¨ –ü–æ–ª–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ —Å –ø–æ–¥–ø–∏—Å—è–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ processed_video_20251223_143022.mp4
‚îÇ
‚îú‚îÄ‚îÄ videos/                     ‚Üê üìπ –ö–æ—Ä–æ—Ç–∫–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ food_and_water_15_*.mp4
‚îÇ   ‚îî‚îÄ‚îÄ sleep_and_phone_23_*.mp4
‚îÇ
‚îú‚îÄ‚îÄ faces/                      ‚Üê üë§ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ª–∏—Ü –Ω–∞—Ä—É—à–∏—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ 15_*_face.jpg
‚îÇ   ‚îî‚îÄ‚îÄ 23_*_face.jpg
‚îÇ
‚îî‚îÄ‚îÄ report_*.json              ‚Üê üìä JSON –æ—Ç—á—ë—Ç —Å–æ –≤—Å–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
```

---

## üéØ –ß–¢–û –î–ï–¢–ï–ö–¢–ò–†–£–ï–¢–°–Ø

–°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç 3 —Ç–∏–ø–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π —Å —Ä—É—Å—Å–∫–∏–º–∏ –ø–æ–¥–ø–∏—Å—è–º–∏:

| –ö–ª–∞—Å—Å | –ü–æ–¥–ø–∏—Å—å –Ω–∞ –≤–∏–¥–µ–æ |
|-------|------------------|
| food_and_water | üçî –ï–¥–∞/–ù–∞–ø–∏—Ç–∫–∏ 0.95 \| –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤ \| 12—Å |
| sleep_and_phone | üò¥ –°–æ–Ω/–¢–µ–ª–µ—Ñ–æ–Ω 0.87 \| –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤ \| 5—Å |
| something | ‚ö†Ô∏è –ù–∞—Ä—É—à–µ–Ω–∏–µ 0.78 \| –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π \| 3—Å |

–ì–¥–µ:
- **0.95** - —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏
- **–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤** - –∏–º—è –∏–∑ –±–∞–∑—ã –ª–∏—Ü
- **12—Å** - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è

---

## ‚ö° –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### –ù–∞ –≤–∞—à–µ–π GPU (RTX 5070):

- **–°–∫–æ—Ä–æ—Å—Ç—å**: 100-150 FPS
- **–ü—Ä–∏–º–µ—Ä**: –í–∏–¥–µ–æ 10 –º–∏–Ω—É—Ç ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ **1-2 –º–∏–Ω—É—Ç—ã** ‚ö°
- **–ü–∞–º—è—Ç—å**: ~4-6 GB VRAM

### –ù–∞ CPU (–µ—Å–ª–∏ GPU –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞):

- **–°–∫–æ—Ä–æ—Å—Ç—å**: 5-10 FPS
- **–ü—Ä–∏–º–µ—Ä**: –í–∏–¥–µ–æ 10 –º–∏–Ω—É—Ç ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ **10-20 –º–∏–Ω—É—Ç**
- **–ü–∞–º—è—Ç—å**: ~2-4 GB RAM

---

## üìù –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### 1. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —É—Ä–æ–∫

```powershell
python detect_violations.py --source "lesson_2023_12_23.mp4" --no-display
```

**–ü–æ–ª—É—á–∏—Ç–µ:**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ: `output/processed_videos/processed_lesson_*.mp4`
- ‚úÖ –§—Ä–∞–≥–º–µ–Ω—Ç—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π: `output/videos/food_and_water_*.mp4`
- ‚úÖ –§–æ—Ç–æ –ª–∏—Ü: `output/faces/*.jpg`
- ‚úÖ JSON –æ—Ç—á—ë—Ç: `output/report_*.json`

### 2. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç–∫–∑–∞–º–µ–Ω

```powershell
# –î–æ–±–∞–≤—å—Ç–µ –ª–∏—Ü–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
python face_database.py

# –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ —ç–∫–∑–∞–º–µ–Ω
python detect_violations.py --source "exam.mp4" --no-display
```

**–í –æ—Ç—á—ë—Ç–µ –±—É–¥—É—Ç –∏–º–µ–Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤!**

### 3. –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–µ–ª–∏

```powershell
# –ü–æ–ª–æ–∂–∏—Ç–µ –≤—Å–µ –≤–∏–¥–µ–æ –≤ videos_to_process/
python detect_violations.py --batch "videos_to_process" --no-display
```

**–í—Å–µ –≤–∏–¥–µ–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã!**

### 4. –í–µ–±-–∫–∞–º–µ—Ä–∞ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)

```powershell
python detect_violations.py --source 0
```

---

## üìà –ê–ù–ê–õ–ò–ó JSON –û–¢–ß–Å–¢–ê

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞:

```json
[
  {
    "id": 1,
    "type": "food_and_water",
    "start_time": "2023-12-23T14:30:45",
    "end_time": "2023-12-23T14:31:12",
    "duration_seconds": 27,
    "person_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "confidence": 0.89,
    "video_path": "output/videos/food_and_water_15_*.mp4",
    "face_path": "output/faces/15_*_face.jpg",
    "frames_count": 810
  }
]
```

### –ë—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑:

```python
import json

# –ó–∞–≥—Ä—É–∑–∏—Ç—å –æ—Ç—á—ë—Ç
with open('output/report_*.json', 'r', encoding='utf-8') as f:
    violations = json.load(f)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
print(f"–í—Å–µ–≥–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π: {len(violations)}")
print(f"–í—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏: {sum(v['duration_seconds'] for v in violations) / 60:.1f} –º–∏–Ω")
```

---

## üîß –ù–ê–°–¢–†–û–ô–ö–ò

### –í `config.py` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

```python
# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)
VIOLATION_DURATION_THRESHOLD = 3.0  # –ú–µ–Ω—å—à–µ = —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–µ–µ

# –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ (0-1)
YOLO_CONFIDENCE = 0.5  # –í—ã—à–µ = —Å—Ç—Ä–æ–∂–µ

# –ë—É—Ñ–µ—Ä –ø–æ—Å–ª–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)
BUFFER_AFTER_VIOLATION = 5
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```powershell
.\.venv\Scripts\python.exe detect_violations.py --help
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
usage: detect_violations.py [-h] [--source SOURCE | --batch BATCH] 
                            [--model MODEL] [--no-display] [--no-save]

–î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã
...
```

‚úÖ **–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!**

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

–ß–∏—Ç–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ:

- **VIDEO_GUIDE.md** ‚Üê –ì–õ–ê–í–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø!
- **VIDEO_CHEATSHEET.md** ‚Üê –ë—ã—Å—Ç—Ä–∞—è —à–ø–∞—Ä–≥–∞–ª–∫–∞
- **README.md** - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **COMMANDS.md** - –í—Å–µ –∫–æ–º–∞–Ω–¥—ã
- **TRAINING_GUIDE.md** - –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

---

## üéØ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

### –®–∞–≥ 1: –ü–æ–ª–æ–∂–∏—Ç–µ –≤–∏–¥–µ–æ

```powershell
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à–µ –≤–∏–¥–µ–æ
copy "D:\path\to\video.mp4" "videos_to_process\"
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É

```powershell
# –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ venv
.\.venv\Scripts\Activate.ps1

# –û–±—Ä–∞–±–æ—Ç–∞–π—Ç–µ
python detect_violations.py --batch "videos_to_process" --no-display
```

### –®–∞–≥ 3: –°–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

```powershell
# –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–ø–∫—É
explorer output

# –°–º–æ—Ç—Ä–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –≤–∏–¥–µ–æ
start output\processed_videos\processed_*.mp4

# –ß–∏—Ç–∞–π—Ç–µ –æ—Ç—á—ë—Ç
notepad output\report_*.json
```

---

## üéâ –ì–û–¢–û–í–û!

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤–∏–¥–µ–æ!**

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

- ‚úÖ –í–∏–¥–µ–æ—Ñ–∞–π–ª—ã (MP4, AVI, MOV, MKV, FLV, WMV)
- ‚úÖ –ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–ø–æ–∫
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ
- ‚úÖ –î–µ—Ç–µ–∫—Ü–∏—è –Ω–∞—Ä—É—à–µ–Ω–∏–π —Å —Ä—É—Å—Å–∫–∏–º–∏ –ø–æ–¥–ø–∏—Å—è–º–∏
- ‚úÖ –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü
- ‚úÖ JSON –æ—Ç—á—ë—Ç—ã
- ‚úÖ –í–µ–±-–∫–∞–º–µ—Ä–∞ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)

### –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã:

- ‚úÖ `detect_violations.py` - –æ–±–Ω–æ–≤–ª—ë–Ω
- ‚úÖ `process_video.bat` - bat-—Ñ–∞–π–ª
- ‚úÖ `VIDEO_GUIDE.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- ‚úÖ `VIDEO_CHEATSHEET.md` - —à–ø–∞—Ä–≥–∞–ª–∫–∞
- ‚úÖ `UPDATED_FOR_VIDEO.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª
- ‚úÖ `videos_to_process/` - –ø–∞–ø–∫–∞ –¥–ª—è –≤–∏–¥–µ–æ

---

## üöÄ –ù–ê–ß–ò–ù–ê–ô–¢–ï –û–ë–†–ê–ë–ê–¢–´–í–ê–¢–¨!

```powershell
python detect_violations.py --source "video.mp4" --no-display
```

**–£–¥–∞—á–∏! üé¨**
